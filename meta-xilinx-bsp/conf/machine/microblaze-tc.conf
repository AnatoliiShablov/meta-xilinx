require conf/multilib.conf
require conf/machine/include/microblaze/arch-microblaze.inc
require conf/machine/include/baremetal-tc.conf

# ILP request an alternative machine dictionary
INHERIT += "xlnx-standalone"
PACKAGEQA_EXTRA_MACHDEFFUNCS .= '${@bb.utils.contains("TUNE_FEATURES", "64-bit", " xlnx_mb64_dict", "", d)}'

# GNU hash style not supported
TARGET_LINK_HASH_STYLE = ""

# Define all of the multilibs supproted by this configuration
MULTILIB_GLOBAL_VARIANTS = "${@extend_variants(d,'MULTILIBS','multilib')}"

MULTILIBS += "multilib:libmbbs"
MULTILIBS += "multilib:libmble"
MULTILIBS += "multilib:libmbm"
MULTILIBS += "multilib:libmbmmh"
MULTILIBS += "multilib:libmblem"
MULTILIBS += "multilib:libmblemmh"
MULTILIBS += "multilib:libmbbsle"
MULTILIBS += "multilib:libmbbsm"
MULTILIBS += "multilib:libmbbsmmh"
MULTILIBS += "multilib:libmbbslem"
MULTILIBS += "multilib:libmbbslemmh"
MULTILIBS += "multilib:libmbm64le"
MULTILIBS += "multilib:libmbm64lem"
MULTILIBS += "multilib:libmbm64lemmh"
MULTILIBS += "multilib:libmbm64bsle"
MULTILIBS += "multilib:libmbm64bslem"
MULTILIBS += "multilib:libmbm64bslemmh"


# Base configuration
# CFLAGS:
DEFAULTTUNE = "microblaze"

AVAILTUNES += "microblaze"
BASE_LIB_tune-microblaze = "lib"
TUNE_FEATURES_tune-microblaze = "microblaze bigendian"
PACKAGE_EXTRA_ARCHS_tune-microblaze = "${TUNE_PKGARCH}"


# bs
# CFLAGS: -mxl-barrel-shift
DEFAULTTUNE_virtclass-multilib-libmbbs = "microblazebs"

AVAILTUNES += "microblazebs"
BASE_LIB_tune-microblazebs = "lib/bs"
TUNE_FEATURES_tune-microblazebs = "microblaze bigendian barrel-shift"
PACKAGE_EXTRA_ARCHS_tune-microblazebs = "${TUNE_PKGARCH}"


# le
# CFLAGS: -mlittle-endian
DEFAULTTUNE_virtclass-multilib-libmble = "microblazele"

AVAILTUNES += "microblazele"
BASE_LIB_tune-microblazele = "lib/le"
TUNE_FEATURES_tune-microblazele = "microblaze"
PACKAGE_EXTRA_ARCHS_tune-microblazele = "${TUNE_PKGARCH}"


# m
# CFLAGS: -mno-xl-soft-mul
DEFAULTTUNE_virtclass-multilib-libmbm = "microblazem"

AVAILTUNES += "microblazem"
BASE_LIB_tune-microblazem = "lib/m"
TUNE_FEATURES_tune-microblazem = "microblaze bigendian multiply-low"
PACKAGE_EXTRA_ARCHS_tune-microblazem = "${TUNE_PKGARCH}"


# m/mh
# CFLAGS: -mno-xl-soft-mul -mxl-multiply-high
DEFAULTTUNE_virtclass-multilib-libmbmmh = "microblazemmh"

AVAILTUNES += "microblazemmh"
BASE_LIB_tune-microblazemmh = "lib/m/mh"
TUNE_FEATURES_tune-microblazemmh = "microblaze bigendian multiply-high"
PACKAGE_EXTRA_ARCHS_tune-microblazemmh = "${TUNE_PKGARCH}"


# le/m
# CFLAGS: -mlittle-endian -mno-xl-soft-mul
DEFAULTTUNE_virtclass-multilib-libmblem = "microblazelem"

AVAILTUNES += "microblazelem"
BASE_LIB_tune-microblazelem = "lib/le/m"
TUNE_FEATURES_tune-microblazelem = "microblaze multiply-low"
PACKAGE_EXTRA_ARCHS_tune-microblazelem = "${TUNE_PKGARCH}"


# le/m/mh
# CFLAGS: -mlittle-endian -mno-xl-soft-mul -mxl-multiply-high
DEFAULTTUNE_virtclass-multilib-libmblemmh = "microblazelemmh"

AVAILTUNES += "microblazelemmh"
BASE_LIB_tune-microblazelemmh = "lib/le/m/mh"
TUNE_FEATURES_tune-microblazelemmh = "microblaze multiply-high"
PACKAGE_EXTRA_ARCHS_tune-microblazelemmh = "${TUNE_PKGARCH}"


# bs/le
# CFLAGS: -mxl-barrel-shift -mlittle-endian
DEFAULTTUNE_virtclass-multilib-libmbbsle = "microblazebsle"

AVAILTUNES += "microblazebsle"
BASE_LIB_tune-microblazebsle = "lib/bs/le"
TUNE_FEATURES_tune-microblazebsle = "microblaze barrel-shift"
PACKAGE_EXTRA_ARCHS_tune-microblazebsle = "${TUNE_PKGARCH}"


# bs/m
# CFLAGS: -mxl-barrel-shift -mno-xl-soft-mul
DEFAULTTUNE_virtclass-multilib-libmbbsm = "microblazebsm"

AVAILTUNES += "microblazebsm"
BASE_LIB_tune-microblazebsm = "lib/bs/m"
TUNE_FEATURES_tune-microblazebsm = "microblaze bigendian barrel-shift multiply-low"
PACKAGE_EXTRA_ARCHS_tune-microblazebsm = "${TUNE_PKGARCH}"


# bs/m/mh
# CFLAGS: -mxl-barrel-shift -mno-xl-soft-mul -mxl-multiply-high
DEFAULTTUNE_virtclass-multilib-libmbbsmmh = "microblazebsmmh"

AVAILTUNES += "microblazebsmmh"
BASE_LIB_tune-microblazebsmmh = "lib/bs/m/mh"
TUNE_FEATURES_tune-microblazebsmmh = "microblaze bigendian barrel-shift multiply-high"
PACKAGE_EXTRA_ARCHS_tune-microblazebsmmh = "${TUNE_PKGARCH}"


# bs/le/m
# CFLAGS: -mxl-barrel-shift -mlittle-endian -mno-xl-soft-mul
DEFAULTTUNE_virtclass-multilib-libmbbslem = "microblazebslem"

AVAILTUNES += "microblazebslem"
BASE_LIB_tune-microblazebslem = "lib/bs/le/m"
TUNE_FEATURES_tune-microblazebslem = "microblaze barrel-shift multiply-low"
PACKAGE_EXTRA_ARCHS_tune-microblazebslem = "${TUNE_PKGARCH}"


# bs/le/m/mh
# CFLAGS: -mxl-barrel-shift -mlittle-endian -mno-xl-soft-mul -mxl-multiply-high
DEFAULTTUNE_virtclass-multilib-libmbbslemmh = "microblazebslemmh"

AVAILTUNES += "microblazebslemmh"
BASE_LIB_tune-microblazebslemmh = "lib/bs/le/m/mh"
TUNE_FEATURES_tune-microblazebslemmh = "microblaze barrel-shift multiply-high"
PACKAGE_EXTRA_ARCHS_tune-microblazebslemmh = "${TUNE_PKGARCH}"


# m64/le
# CFLAGS: -m64 -mlittle-endian
DEFAULTTUNE_virtclass-multilib-libmbm64le = "microblaze64le"

AVAILTUNES += "microblaze64le"
BASE_LIB_tune-microblaze64le = "lib/m64/le"
TUNE_FEATURES_tune-microblaze64le = "microblaze 64-bit"
PACKAGE_EXTRA_ARCHS_tune-microblaze64le = "${TUNE_PKGARCH}"


# m64/le/m
# CFLAGS: -m64 -mlittle-endian -mno-xl-soft-mul
DEFAULTTUNE_virtclass-multilib-libmbm64lem = "microblaze64lem"

AVAILTUNES += "microblaze64lem"
BASE_LIB_tune-microblaze64lem = "lib/m64/le/m"
TUNE_FEATURES_tune-microblaze64lem = "microblaze 64-bit multiply-low"
PACKAGE_EXTRA_ARCHS_tune-microblaze64lem = "${TUNE_PKGARCH}"


# m64/le/m/mh
# CFLAGS: -m64 -mlittle-endian -mno-xl-soft-mul -mxl-multiply-high
DEFAULTTUNE_virtclass-multilib-libmbm64lemmh = "microblaze64lemmh"

AVAILTUNES += "microblaze64lemmh"
BASE_LIB_tune-microblaze64lemmh = "lib/m64/le/m/mh"
TUNE_FEATURES_tune-microblaze64lemmh = "microblaze 64-bit multiply-high"
PACKAGE_EXTRA_ARCHS_tune-microblaze64lemmh = "${TUNE_PKGARCH}"


# m64/bs/le
# CFLAGS: -m64 -mxl-barrel-shift -mlittle-endian
DEFAULTTUNE_virtclass-multilib-libmbm64bsle = "microblaze64bsle"

AVAILTUNES += "microblaze64bsle"
BASE_LIB_tune-microblaze64bsle = "lib/m64/bs/le"
TUNE_FEATURES_tune-microblaze64bsle = "microblaze 64-bit barrel-shift"
PACKAGE_EXTRA_ARCHS_tune-microblaze64bsle = "${TUNE_PKGARCH}"


# m64/bs/le/m
# CFLAGS: -m64 -mxl-barrel-shift -mlittle-endian -mno-xl-soft-mul
DEFAULTTUNE_virtclass-multilib-libmbm64bslem = "microblaze64bslem"

AVAILTUNES += "microblaze64bslem"
BASE_LIB_tune-microblaze64bslem = "lib/m64/bs/le/m"
TUNE_FEATURES_tune-microblaze64bslem = "microblaze 64-bit barrel-shift multiply-low"
PACKAGE_EXTRA_ARCHS_tune-microblaze64bslem = "${TUNE_PKGARCH}"


# m64/bs/le/m/mh
# CFLAGS: -m64 -mxl-barrel-shift -mlittle-endian -mno-xl-soft-mul -mxl-multiply-high
DEFAULTTUNE_virtclass-multilib-libmbm64bslemmh = "microblaze64bslemmh"

AVAILTUNES += "microblaze64bslemmh"
BASE_LIB_tune-microblaze64bslemmh = "lib/m64/bs/le/m/mh"
TUNE_FEATURES_tune-microblaze64bslemmh = "microblaze 64-bit barrel-shift multiply-high"
PACKAGE_EXTRA_ARCHS_tune-microblaze64bslemmh = "${TUNE_PKGARCH}"
